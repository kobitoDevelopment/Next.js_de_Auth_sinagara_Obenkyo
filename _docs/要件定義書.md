# プロジェクト要件定義書

## 1. プロジェクト概要

- **プロジェクト名**: Next.jsSupabase学習プロジェクト
- **目的**: フロントエンド開発そのものの設計や開発・Next.jsの作法を、バックエンドにSupabaseを用いて学習する。
- **背景**: 転職先がNext.js中心のスタックなため、予習しておきたい。
- **ステークホルダー**:
  - 開発者自身
  - コードレビュアー

## 2. ビジネス要件

- **解決すべき課題**:
  - 汎用的なフロントエンド開発スキル・Next.jsの習得
  - Supabaseを用いたバックエンド連携の理解
  - 認証・認可システムの実装知識の獲得
- **ビジネス目標**:
  - Next.jsの基本機能を習得する
  - Supabaseのの基本機能を習得する
  - Webアプリケーションのフロントエンドに求められる技能を習得する
- **成功基準（KPI）**:
  - 全ての認証機能が正常に動作するWebアプリケーションの完成
  - GitHub上でのコード管理と適切なコミット履歴の作成
  - CI/CDによる品質保持とデプロイの自動化
  - 学習内容のコメントをソース内に残す

## 3. 機能要件

### 3.1 ユーザー認証

- **サインイン機能**:
  - メールアドレスとパスワードによるサインイン
  - サインイン失敗時のエラーハンドリング
- **サインアウト機能**:
  - ワンクリックでのサインアウト処理
  - サインアウト後のリダイレクト制御
- **アカウント登録機能**:
  - メールアドレスとパスワードによる新規登録
  - 既存ユーザーのユーザー名・メールアドレスと重複していないかチェック
  - パスワード強度チェック
  - 利用規約・プライバシーポリシーへの同意
- **アカウント情報編集機能**:
  - ユーザープロフィール情報の更新
  - 既存ユーザーのユーザー名・メールアドレスと重複していないかチェック
  - パスワード変更機能
- **アカウント削除機能**:
  - アカウント削除の確認フロー
  - 関連データの削除処理
- **セッション管理**:
  - Cookieによる1日間のセッション保持

### 3.2 認可とアクセス制御

- **未認証ユーザーのリダイレクト制御**:
  - 保護されたルートへのアクセス時、サインインぺージへ自動リダイレクト
  - サインイン・サインアップ以外のすべてのルートで認証チェックを実施
- **権限管理**:
  - 基本的なユーザー権限の実装
  - 自分のアカウント情報のみ編集可能な制御

### 3.3 その他の機能

- **ダッシュボード画面**:
  - サインイン後のホーム画面
  - ユーザー情報の表示

## 4. 非機能要件

### 4.1 パフォーマンス

- **想定ユーザー数**: 1時間あたり100ユニークユーザー
- **想定リクエスト数**: 1時間あたり約1,000〜2,000リクエスト
- **レスポンス時間**: ページロードは2秒以内、API応答は500ms以内

### 4.2 セキュリティ要件

- **データ暗号化**:
  - Supabaseによるデータベース暗号化の活用
  - HTTPS通信の強制
- **パスワード管理**:
  - パスワードハッシュ化の実装
- **HTTPS通信**:
  - 本番環境での適切なSSL/TLS設定
- **クロスサイトスクリプティング対策**:
  - Next.jsのReactコンポーネントによる自動エスケープの活用（JSX内でのHTMLエスケープは自動）
  - dangerouslySetInnerHTMLの使用回避
- **SQLインジェクション対策**:
  - Supabase SDKのパラメータ化クエリによる自動的な防御
- **CSRF対策**:
  - カスタムAPI実装時は、Next.jsのAPI Routesでの追加のCSRFトークン検証を実施
  - SameSite=Strictクッキー属性の設定

### 4.3 可用性要件

- **稼働率**: 学習プロジェクトのため、高可用性は必須ではない
- **障害復旧時間**: バックアップからの復旧手順の理解と実践

### 4.4 拡張性要件

- ## **Vercelでのスケーラビリティ対応**:
  - Vercelのエッジネットワークによるグローバル配信と自動スケーリング
  - Serverless Functions/Edge Functionsの活用によるコールドスタート時間の最小化
  - ISRパターンの活用によるデータ更新とキャッシング最適化

### 4.5 保守性要件

- **バックアップ頻度**: Supabaseのバックアップ機能の理解と設定
- **メンテナンス計画**: 依存パッケージの定期的な更新チェック

## 5. 技術要件

### 5.1 アーキテクチャ

- **フロントエンド**:
  - Next.js latest（App Router使用）
  - TypeScript
  - CSS Module
  - Zod
  - StyleLint()
  - PostCSS
  - Jest
  - bcrypt
  - prettier
- **バックエンド**:
  - Supabase Database
  - Supabase Storage
  - Supabase Edge Functions
- **データベース**:
  - PostgreSQL（Supabase）

### 5.2 インフラ

- **Vercel**:
  - Next.jsアプリケーションのホスティング
  - CI/CDパイプラインの設定
- **Supabase**:
  - クラウドホスティングされたPostgreSQLデータベース
- **バージョン管理**:
  - GitHub

## 6. デザイン要件

- シンプルで直感的なUI
- **UIデザイン要件**:
  - アクセシビリティAA準拠
- **レスポンシブ対応**:
  - モバイル・デスクトップの2サイズ対応

## 7. プロジェクト管理

### 7.1 スケジュール

- **開始日**: 2025-04-01
- **終了日（納期）**: 2025-08-31（5ヶ月間）
- **マイルストーン**:
  - 4月: React / Next.js / TypeScript の基礎学習
  - 5月: 本プロジェクトのリポジトリ作成と開発スタート
  - 6月: 各機能毎に開発開始 / レビュー依頼
  - 7月: 開発完了
  - 8月: 学習内容の振り返りと

### 7.2 予算

- **開発費用**: 個人学習プロジェクトのため開発費用なし
- **インフラ費用**:
  - Vercel: 無料枠
  - Supabase: 無料枠
- **運用費用**: 無料枠で学習を実施するため準備なし

### 7.3 リソース

- **開発チーム編成**:
  - 個人開発
- **役割分担**:
  - フロントエンド開発: 開発者自身
  - バックエンド開発: 開発者自身
  - UI/UXデザイン: 開発者自身

## 8. テスト要件

- **単体テスト**:
  - Jest/React Testing Libraryによるコンポーネントテスト
  - 重要な関数のテスト
- **統合テスト**:
  - playwrightを用いたEnd to Endテスト
- **UIテスト**:
  - レスポンシブデザインの確認
  - クロスブラウザチェック（Chrome, Firefox, Safariそれぞれ最新バージョン）
- **手動テスト**:
  - 各機能の動作確認チェックリストの作成と実行

## 9. 制約条件

- **技術的制約**:
  - Supabase無料枠の制限内での開発（データベース容量、帯域など）
  - 学習プロジェクトのため複雑な機能は実装しない
- **時間的制約**:
  - 5ヶ月での完成を目標とする
- **その他制約事項**:
  - 学習目的のため、コードの可読性と適切なコメントを重視する

## 10. 参考資料・添付資料

- **学習リソース**:
  - [Next.js公式ドキュメント](https://nextjs.org/docs/app/getting-started)
  - [Supabase公式ドキュメント](https://supabase.com/docs)
